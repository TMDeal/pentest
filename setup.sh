#!/bin/bash

git submodule update --init --recursive

#####################################

echo "Setting up CeWL"
echo -e "================\n\n"

cd CeWL
bundle install
sudo apt-get install libimage-exiftool-perl -y

ln -sf ../CeWL/cewl.rb ../bin/cewl

cd ..

echo -e "\n\nCeWL setup complete"
echo -e "===================\n\n"

#####################################

#####################################

echo "Setting up GreatSCT"
echo -e "================\n\n"

cd GreatSCT/setup
sudo ./setup.sh -c

cd ..

ln -sf ../GreatSCT/GreatSCT.py ../bin/GreatSCT
find . | grep -E "(__pycache__|\.pyc|\.pyo$)" | xargs rm -rf

cd ..

echo -e "\n\nGreatSCT setup complete"
echo -e "===================\n\n"

#####################################

echo "Setting up kerbrute"
echo -e "================\n\n"

cd kerbrute
../scripts/download_github_release "ropnop/kerbrute"

kerbrute_binary="kerbrute_linux_amd64"
chmod +x ./kerbrute_linux_amd64
ln -sf ../kerbrute/kerbrute_linux_amd64 ../bin/kerbrute

cd ..


echo -e "\n\nkerbrute setup complete"
echo -e "===================\n\n"

#####################################

echo "Setting up PEASS"
echo -e "================\n\n"

cd PEASS
../scripts/download_github_release "carlospolop/PEASS-ng"

cd ..

echo -e "\n\nPEASS setup complete"
echo -e "===================\n\n"

#####################################

echo "Setting up scripts"
echo -e "================\n\n"

cd scripts
ln -sf ../scripts/smbver ../bin/smbver
ln -sf ../scripts/tightvnc_decrypt ../bin/tightvnc_decrypt
ln -sf ../scripts/wesng ../bin/wesng

cd ..

echo -e "\n\nscripts setup complete"
echo -e "===================\n\n"

#####################################

echo -e "\n\nSetup Complete!"
